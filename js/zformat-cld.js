/* Copyright 2014 lennart.borgman@gmail.com */ (function(){window.addEventListener("load",function(){(function(b){Object.keys(b).forEach(function(c){var f=b[c],e=f[0],f=f[1],s=document.createElement(e);s.setAttribute("id",c);"script"===e||"style"===e?(s.appendChild(document.createTextNode(f)),document.head.appendChild(s)):(s.innerHTML=f,document.body.appendChild(s))})})({mh1:["NAV",'\x3cul id\x3d"mh1-top-menu" class\x3d"mh1-hover-menu"\x3e\n\x3cli class\x3d"mh1-menu-item"\x3e\n\x3c!-- \x3ca id\x3d"mh1-title" title\x3d"Visit" href\x3d"http://ourcomments.org/psyblog/"\x3eOurComments on Psychology \x3c/a\x3e --\x3e\n\x3cspan id\x3d"mh1-title" title\x3d"Menu"\x3eOurComments on Psychology \x3c/span\x3e\n\x3cul id\x3d"mh1-main-menu" class\x3d"Xmh1-menu-item"\x3e\n\x3cli id\x3d"mh1-about-menu-item" class\x3d"mh1-menu-item"\x3e\n\x3ca href\x3d"http://ourcomments.org/psyblog/about/" class\x3d"Xmh1-help" title\x3d"Read about OurComments on Psychology"\x3eAbout\x3c/a\x3e\n\x3c/li\x3e\n\x3cli id\x3d"mh1-blog-menu-item" class\x3d"mh1-menu-item mh1-hover-menu"\x3e\n\x3cspan\x3eBlogs\x26nbsp;\n\x3ca href\x3d"http://ourcomments.org/psyblog/site-list/" class\x3d"mh1-help" title\x3d"Info about blogs"\x3e?\x3c/a\x3e\x3c/span\x3e\n\x3cul id\x3d"mh1-blog-list-menu" class\x3d"Xmh1-menu-item"\x3e\n\x3cli id\x3d"mh1-blog-list-container-blogs" class\x3d"Xmh1-menu-item"\x3e\n\x3cdiv style\x3d"padding: 40px; width: 200px;"\x3eFetching blog list...\x3c/div\x3e\n\x3c/li\x3e\n\x3c/ul\x3e\n\x3c/li\x3e\n\x3c/ul\x3e\n\x3c/li\x3e\n\x3c/ul\x3e\n\x3cdiv id\x3d"mh1-search-symbol" title\x3d"Search!"\x3e\n\x3cdiv id\x3d"mh1-glass"\x3e\x3c/div\x3e\n\x3cdiv id\x3d"mh1-glass-rod"\x3e\x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv id\x3d"mh1-hamburger"\x3e\n\x3cdiv\x3e\x3c/div\x3e\n\x3cdiv\x3e\x3c/div\x3e\n\x3cdiv\x3e\x3c/div\x3e\n\x3c/div\x3e\n\x3cnav id\x3d"mh1-search"\x3e\n\x3cul id\x3d"mh1-main-search"\x3e\n\x3cli\x3e\n\x3cspan id\x3d"mh1-search-psyblog-span"\x3e\n\x3cinput type\x3d"search" size\x3d"5" id\x3d"mh1-search-psyblog" title\x3d"Search all blogs in OurComments on Psychology" placeholder\x3d"Search all blogs"\x3e\n\x3ca href\x3d"http://ourcomments.org/psyblog/site-list/" class\x3d"mh1-help" title\x3d"Help for Search OurComments on Psychology"\x3e?\x3c/a\x3e\n\x3cspan class\x3d"mh1-menu-details"\x3e - Search all blogs in OurComments on Psychology.\x3c/span\x3e\n\x3c/span\x3e\n\x3c/li\x3e\n\x3cli\x3e\n\x3cspan id\x3d"mh1-zotero-search"\x3e\n\x3cinput type\x3d"search" size\x3d"5" id\x3d"mh1-search-zotero" title\x3d"Search our Zotero library (From Some Psychologists)" placeholder\x3d"Search Zotero"\x3e\n\x3ca href\x3d"http://ourcomments.org/psyblog/our-zotero-library/" class\x3d"mh1-help" title\x3d"Help for searching our Zotero library"\x3e?\x3c/a\x3e\n\x3cspan class\x3d"mh1-menu-details"\x3e - Search our psychology related links.\x3c/span\x3e\n\x3c/span\x3e\n\x3c/li\x3e\n\x3c/ul\x3e\n\x3c/nav\x3e\n\x3c!--?php\n/* You may use PHP to get content! Your context is add_action(\'wp_footer\', ..., 1001) */\n// echo "Some text from PHP echo!";\n?--\x3e\n\x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\n'],
mh1Css:["STYLE",'/* Tip: Use !important on all values - except those that you want to change with javascript. */\n#mh1 div, #mh1 span, #mh1 a, #mh1 ul, #mh1 li, {\nborder: 0;\nfont-family: inherit;\nfont-size: 100%;\nfont-style: inherit;\nfont-weight: inherit;\nmargin: 0;\noutline: 0;\npadding: 0;\nvertical-align: baseline;\n}\n#mh1 {\nfont-family: Arial !important;\nposition:absolute;\nz-index: 400 !important; /* wp toolbar 500 */\ntop:0;\nleft:0!important;\nright:0 ! important;\ndisplay: block !important;\nbackground:#005E8E !important;\nxpadding: 6px!important;\nfont-size: 14px !important;\nborder-bottom: 1px solid white !important;\n}\n#mh1.mh1-wp {\n}\n#mh1 * {\nbox-sizing: border-box !important;\n-moz-box-sizing: border-box !important;\n}\n#mh1 ::-webkit-input-placeholder { color: #54A4CC!important; }\n#mh1 ::-moz-placeholder { color: #54A4CC!important; }\n#mh1 :-ms-input-placeholder { color: #54A4CC!important; }\n#mh1 a {\ncolor: #7CD3FF!important;\ntext-decoration: none!important;\ndisplay: inline-block !important;\nmargin-left: 0 !important;\n}\n#mh1 #mh1-title {\nfont-weight: bold!important;\ncolor: #7CD3FF!important;\npadding: 6px !important;\n}\n#mh1 a.mh1-help {\nbackground-color:#008ed7 !important;\ncolor: #eee!important;\nborder-radius: 6px!important;\npadding-left:3px!important;\npadding-right:3px!important;\npadding-top: 0 !important;\npadding-bottom: 0 !important;\n}\n#mh1 a.mh1-help:hover {\ncolor: black!important;\nbackground-color: #82c8ec !important;\n}\n/* Mobile style menu icon */\n#mh1 #mh1-hamburger {\nfloat: right !important;\nmargin: 0 !important;\nmargin-right: 4px !important;\nborder-radius: 3px 3px 3px 3px !important;\ncursor: pointer !important;\ndisplay: inline-block !important;\nheight: 22px !important;\npadding: 2px 2px 2px !important;\nposition: relative !important;\nwidth: 24px !important;\nbackground: #7CD3FF!important;\n}\n#mh1 #mh1-hamburger:hover {\nbackground: #45ade2!important;\n}\n/* The white stripes in the hamburger button */\n#mh1 #mh1-hamburger div {\nbackground-color: #bee9ff !important;\nheight: 2px !important;\nmargin-top: 3px !important;\nwidth: auto !important;\n}\n#mh1 ul {\nmargin: 0 !important;\npadding: 0 !important;\nlist-style-position: outside !important;\nlist-style-type: none !important;\nlist-style-image: none !important;\n}\n#mh1 ul li {\npadding: 0 !important;\nmargin: 0 !important;\n}\n#mh1 ul li \x3e * { display: inline-block !important; }\n#mh1 ul {\ndisplay: inline-block !important;\n}\n#mh1 ul li {\ndisplay: inline-block !important;\n}\n/* #mh1 * { z-index: inherit !important; } */\n#mh1 #mh1-search {\nfloat: right !important;\ntransition: all 0.5s ease-in-out !important;\nz-index: 400 !important;\n}\n#mh1 input[type\x3d"search"] {\ndisplay: inline-block !important;\nmargin: 0 !important;\npadding: 2px!important;\npadding-top: 0px!important;\npadding-bottom: 0px!important;\nborder-width: 1px!important;\nborder-color: #A9E3FF !important;\nborder-style: solid;\nborder-radius: 5px!important;\nbackground-color: #CBEEFF!important;\n}\n#mh1 input[type\x3d"search"]:hover {\nbackground-color: rgb(255, 255, 255) !important;\n}\n#mh1 input[type\x3d"search"]:focus {\nbackground-color: rgb(255, 255, 255) !important;\nborder-color: blue;\nbackground-position: right !important;\nbackground-image: url(http://www.google.com/cse/intl/en/images/google_custom_search_watermark.gif);\nbackground-repeat: no-repeat !important;\n}\n/* #mh1 input[type\x3d"search"]#mh1-search-psyblog:focus { } */\n/* Blog list menu */\n#mh1-blog-list-header {\npadding: 6px !important;\npadding-left: 40px !important;\nbackground: #eee !important;\n}\n#mh1-main-menu a {\npadding: 0 !important;\n}\n#mh1-top-menu {\ndisplay: inline-block !important;\ncursor: pointer !important;\n}\n#mh1-top-menu * {\nfont-size: 14px !important;\n}\n#mh1 #mh1-top-menu.mh1-hover-menu:hover #mh1-main-menu {\ndisplay: block !important;\n}\n#mh1 #mh1-top-menu #mh1-main-menu.mh1-visible-submenu {\ndisplay: block !important;\n}\n#mh1 #mh1-main-menu {\ndisplay: none !important;\nposition: absolute !important;\ntop: 100% !important;\nleft: 0% !important;\nmargin: 0 !important;\n}\n#mh1 #mh1-top-menu ul {\nbackground:#005E8E !important;\n}\n#mh1 #mh1-top-menu ul {\nwidth: auto !important;\n}\n#mh1 #mh1-top-menu * {\nmargin: 0 !important;\n}\n#mh1 #mh1-top-menu:after {\ncontent: ""; clear: both !important; display: block !important;\n}\n#mh1 #mh1-top-menu ul li {\ndisplay: block !important;\nwidth: auto !important;\n}\n/* #mh1 #mh1-top-menu ul li * { */\n#mh1 .mh1-menu-item {\ncolor:#cbeeff!important;\ndisplay: block !important;\n}\n#mh1-main-menu .mh1-menu-item \x3e a, #mh1-main-menu .mh1-menu-item \x3e span {\npadding: 15px 20px !important;\nxwidth: 300px !important;\n}\n#mh1 .mh1-menu-item:hover {\nbackground-color: black !important;\ntext-shadow: none !important;\n}\n#mh1 #mh1-main-menu li {\nborder-left: 1px solid #3A7997!important;\nborder-top: 1px solid #3A7997!important;\nborder-bottom: 1px solid #14303F !important;\n}\n#mh1 #mh1-blog-menu-item {\nposition: relative !important;\n}\n#mh1 #mh1-blog-menu-item #mh1-blog-list-menu {\ndisplay: none !important;\nposition: absolute !important;\ntop: 0% !important;\nleft: 80px !important;\n}\n#mh1 #mh1-blog-menu-item #mh1-blog-list-menu li {\nwidth: 240px !important;\n}\n#mh1 #mh1-blog-menu-item.mh1-hover-menu:hover #mh1-blog-list-menu {\ndisplay: block !important;\n}\n#mh1 #mh1-blog-menu-item #mh1-blog-list-menu.mh1-visible-submenu {\ndisplay: block !important;\n}\n/* A little fun with searching!\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d */\n#mh1-glass {\nposition: absolute !important;\ntop: 6px !important;\nleft: 6px !important;\nborder: 2px solid #7CD3FF !important;\nborder-radius: 50% !important;\nwidth: 12px !important;\nheight: 12px !important; \ndisplay: block !important;\n}\n#mh1-glass-rod {\ntransform: rotate(-45deg) !important;\n-webkit-transform: rotate(-45deg) !important;\nwidth: 2px !important;\nheight: 12px !important;\nposition: absolute !important;\ntop: 12px !important;\nleft: 18px !important;\nbackground-color: #7CD3FF !important;\n}\n#mh1-search-symbol {\ndisplay: inline-block !important;\nwidth: 32px !important;\nheight: 28px !important;\nposition: relative !important;\ncursor: pointer !important;\nfloat: right !important;\npadding: 2px !important;\n}\n#mh1-search-symbol:hover {\nbackground: black !important;\n}\n#mh1-search-symbol * {\npadding: 0 !important;\nmargin: 0 !important;\n}\n/* Screen width adjustments */\n@media screen and ( min-width: 900px ) {\n#mh1 #mh1-hamburger { display: none !important; }\n#mh1 #mh1-search-symbol { display: none !important; }\n#mh1 #mh1-search {\nmargin-top: 5px !important;\nposition: static !important;\ndisplay: inline-block !important;\noverflow: visible !important;\nwidth: auto !important;\nfloat: right !important;\n}\n#mh1 #mh1-main-search {\ndisplay: inline-block;\nposition: static;\nmargin-right: 8px !important;\nbackground-color: transparent !important;\nwidth: auto !important;\nfloat: align: right;\n}\n/* #mh1 ul { display: inline-block !important; } */\n/* #mh1 ul li { display: inline-block !important; border: none !important; } */\n/* #mh1 ul li \x3e * { display: inline-block !important; xpadding: 0 !important; margin-left: 20px !important; } */\n#mh1 .mh1-menu-details { display: none !important; }\n#mh1 input[type\x3d"search"] {\nwidth: 130px!important;\n}\n#mh1 input[type\x3d"search"]:focus {\ntransition: all 0.5s ease-in-out !important;\nwidth: 440px !important;\npadding: 4px !important;\n}\n#mh1 input[type\x3d"search"]:hover {\ntransition: all 0.5s ease-in-out !important;\n}\n}\n@media screen and ( max-width: 899px ) {\n#mh1 #mh1-hamburger { display: inline-block !important; }\n#mh1 #mh1-hamburger { display: none !important; }\n#mh1 #mh1-search {\ndisplay: none;\nheight: 0;\n}\n#mh1 #mh1-search {\nposition: absolute;\nxdisplay: none;\nxheight: 0;\noverflow: hidden !important;\nfloat: none !important;\nmax-width: 400px;\nleft: auto !important;\nright: 0 !important;\nborder: 2px solid white;\nborder-radius: 30px !important;\nborder-top-right-radius: 0px !important;\nbackground-color: inherit !important;\n}\n#mh1 #mh1-search-sym:hover #mh1-main-search {\ndisplay: block !important;\nheight: auto;\n}\n#mh1-main-search ul {\ndisplay: block !important;\nmargin-left: 0 !important;\nbackground-color: inherit !important;\nleft: 0 !important;\nright: 0 !important;\n}\n#mh1-main-search .mh1-menu-details { display: inline-block!important; color: #7CD3FF !important; }\n#mh1-main-search ul { display: block !important; }\n#mh1-search ul li {\nwidth: 100% !important;\nborder-bottom: 1px solid white !important;\n}\n#mh1-search ul li \x3e span {\ndisplay: block !important;\npadding: 20px !important;\npadding-left: 20px !important;\nmargin: 0 !important;\nwidth: 100% !important;\n}\n#mh1 #mh1-main-search { float: none !important; }\n#mh1 input[type\x3d"search"] {\nwidth: 100% !important;\nfont-size: 16px; /* Minimu to avoid zoom on android */\ndisplay: block !important;\npadding: 4px !important;\nbackground-color: #e2f5ff!important;\nmargin-bottom: 4px !important;\n}\n}\n'],
mh1Js:["SCRIPT",'(function() {\nvar ham \x3d document.getElementById("mh1-hamburger");\nvar ham \x3d document.getElementById("mh1-search-symbol");\nvar menus \x3d document.getElementById("mh1-search");\nvar banner \x3d document.getElementById("mh1");\nvar html \x3d document.getElementsByTagName("html")[0];\nvar wpadminbar \x3d document.getElementById("wpadminbar");\nham.addEventListener("click", function() {\nconsole.log("menus display, height", menus.style.display, menus.style.height);\nvar menusShown \x3d false;\nvar menusCStyle \x3d window.getComputedStyle(menus);\nvar menusHeight \x3d menusCStyle.height;\nconsole.log("---- menusHeight", menusHeight);\nif (0 !\x3d parseInt(menusHeight)) menusShown \x3d true;\nif (!menusShown) {\nconsole.log("menus", menus);\nvar bannerPosition \x3d banner.style.position; // "absolute";\nif ("" \x3d\x3d bannerPosition) {\nmenus.style.position \x3d "absolute";\n} else {\nmenus.style.position \x3d bannerPosition;\n}\n// console.log("banner.style.position", banner.style.position);\n// console.log("menus.style.position", menus.style.position);\nvar bannerBR \x3d banner.getBoundingClientRect();\nvar menuTop \x3d bannerBR.bottom;\nconsole.log("bannerBR.bottom", bannerBR.bottom, "bannerBR.height", bannerBR.height);\nmenus.style.top \x3d menuTop + "px";\n// console.log("menus.style.top", menus.style.top);\n// Get height: \nmenus.style.visibility \x3d "hidden";\nmenus.style.display \x3d "block";\nmenus.style.height \x3d "auto";\nvar mr \x3d menus.getBoundingClientRect();\nmenus.style.visibility \x3d null;\nvar newHeight \x3d mr.height;\nconsole.log("New height:", newHeight, mr);\nif ("absolute" \x3d\x3d menus.style.position) {\nvar htmlMTopBcr \x3d html.getBoundingClientRect().top;\n// console.log("htmlMarginTop from bcr", htmlMTopBcr);\nvar htmlMTopGcs \x3d window.getComputedStyle(html).marginTop;\n// console.log("htmlMarginTop from gcs", htmlMTopGcs);\n// console.log("mr", mr, mr.top);\n// console.log("window.scrollY", window.scrollY);\nmenuTop +\x3d window.scrollY;\n// Fix-me: For some reason I do not understand at all\n// I have to subtract the height of wpadminbar here.\nif (wpadminbar) {\nvar wpBR \x3d wpadminbar.getBoundingClientRect();\nmenuTop -\x3d wpBR.height;\n}\nmenus.style.top \x3d menuTop + "px";\n// console.log("menus.style.top", menus.style.top);\n// Tell we want the position again:\nmr \x3d menus.getBoundingClientRect();\n// Fix-me: Did not help since getBoundingClientRect\n// does not wait for display update.\n}\n// Unfortunately this prevents transition,\n// but we can work around it by:\n// 1. Set a height:\nmenus.style.height \x3d "1px";\n// 2. Set the real height in a timeout:\nsetTimeout(function() {\nmenus.style.height \x3d newHeight+"px";\nmenus.style.borderWidth \x3d "2px";\n}, 10);\n} else {\nmenus.style.height \x3d "0";\nmenus.style.borderWidth \x3d "0";\n}\n});\n})();\n(function() {\nvar menus \x3d document.getElementById("mh1-search");\nvar zField \x3d document.getElementById("mh1-search-zotero");\nzField.addEventListener("focus", function(ev) {\nmenus.style.height \x3d "auto";\n});\nzField.addEventListener("keyup", function(ev) {\nif (13 \x3d\x3d ev.keyCode) {\nvar url \x3d "http://ourcomments.org/psych/zfsp.html?q\x3d"+encodeURIComponent(zField.value);\n// window.location.href \x3d url;\nvar eA \x3d document.createElement("a");\neA.setAttribute("href", url);\neA.setAttribute("target", "_blank");\neA.dispatchEvent(new MouseEvent("click"));\n}\n});\nvar pField \x3d document.getElementById("mh1-search-psyblog");\npField.addEventListener("focus", function(ev) {\nmenus.style.height \x3d "auto";\n});\npField.addEventListener("keyup", function(ev) {\nif (13 \x3d\x3d ev.keyCode) {\nvar url \x3d "http://dl.dropboxusercontent.com/u/848981/it/cw/cse-psyblog.html?q\x3d"\n+encodeURIComponent(pField.value);\n// window.location.href \x3d url;\nvar eA \x3d document.createElement("a");\neA.setAttribute("href", url);\neA.setAttribute("target", "_blank");\neA.dispatchEvent(new MouseEvent("click"));\n} else {\nvar len \x3d pField.value.length;\nif (0 \x3d\x3d len) {\npField.style.backgroundImage \x3d null;\n} else {\npField.style.backgroundImage \x3d "none";\n}\n}\n});\n})();\n(function() {\nvar touchDevice \x3d false;\nif ((\'ontouchstart\' in window) ||\n(navigator.maxTouchPoints \x3e 0) ||\n(navigator.msMaxTouchPoints \x3e 0)) {\n/* browser with either Touch Events of Pointer Events\nrunning on touch-capable device */\ntouchDevice \x3d true;\n// alert("touchDevice");\n}\nvar mh1Title \x3d document.getElementById("mh1-title");\nmh1Title.addEventListener("click", function() {\nvar mm \x3d document.getElementById("mh1-main-menu");\nmm.classList.toggle("mh1-visible-submenu");\n});\nvar blogMenuItem \x3d document.getElementById("mh1-blog-menu-item");\nblogMenuItem.addEventListener("click", function() {\nvar mm \x3d document.getElementById("mh1-blog-list-menu");\nmm.classList.toggle("mh1-visible-submenu");\n});\nif (!touchDevice) {\nvar topMenuItem \x3d document.getElementById("mh1-top-menu");\ntopMenuItem.classList.add("mh1-hover-menu");\nblogMenuItem.classList.add("mh1-hover-menu");\n}\nvar blogListTop \x3d document.getElementById("mh1-top-menu");\nvar blogListContainer \x3d document.getElementById("mh1-blog-list-container-blogs");\nvar blogList;\nvar rq;\nfunction request_blog_list() {\nrq \x3d new XMLHttpRequest();\nrq.onload \x3d function() {\nconsole.log(rq.responseText);\nblogList \x3d rq.responseText;\nvar tempDiv \x3d document.createElement("div");\ntempDiv.innerHTML \x3d blogList;\nwhile (blogListContainer.firstChild) blogListContainer.removeChild(blogListContainer.firstChild);\n// console.log("tempDiv", tempDiv);\nblogListContainer.appendChild(tempDiv.firstChild.firstChild);\nvar liMs \x3d blogListContainer.querySelectorAll("li");\nconsole.log("liMs", liMs);\nfor (var i\x3d0, len\x3dliMs.length; i\x3clen; i++) {\nconsole.log(liMs[i]);\nliMs[i].classList.add("mh1-menu-item");\n}\n};\nrq.onerror \x3d function() {\nconsole.log("Could not fetch blog list.\x3cbr \x3eError:"+rq.responseText);\nblogList \x3d \'\x3cdiv style\x3d"background:yellow; padding:20px; width:200px; border:1px solid red;"\x3e\'\n+\'Could not fetch blog list.\x3cbr \x3eError: \'+rq.responseText+\'\x3c/div\x3e\';\nblogListContainer.innerHTML \x3d blogList;\n};\nrq.ontimeout \x3d function() {\nconsole.log("Could not fetch blog list.\x3cbr \x3eTimeout:"+rq.responseText);\nvar blogList \x3d \'\x3cdiv style\x3d"color: red; padding:20px; width:100%; border:1px solid red;"\x3e\'\n+\'Could not fetch blog list.\x3cbr \x3eTimeout \'+rq.responseText+\' (trying again...)\x3c/div\x3e\';\nblogListContainer.innerHTML \x3d blogList;\nsetTimeout( function() { request_blog_list(); }, 1000);\n};\nrq.timeout \x3d 2000; // milliseconds, for Powweb\x3d2000\n// ajaxurl is only available for admin, or???\nurl \x3d ajaxurl + "?action\x3dmh1_blog_list"+"\x26nc" + Math.random() + "\x3d1";\nconsole.log("blog list url", url);\n// Fix-me: convert to POST\nrq.open("GET", url, true);\nrq.send();\n}\n// blogListTop.addEventListener("mouseover", function() {\nblogMenuItem.addEventListener("mouseover", function() {\nif (rq) return;\nif (typeof ajaxurl \x3d\x3d \'undefined\') {\n// console.log("blogListTop, no ajaxurl");\najaxurl \x3d "http://ourcomments.org/psyblog/wp-admin/admin-ajax.php"; \nif (typeof ajaxurl \x3d\x3d \'undefined\') {\nvar s \x3d document.createElement("style");\ns.setAttribute("type", "text/css");\ns.appendChild(document.createTextNode(\n"#mh1 #mh1-top-menu:hover #mh1-main-menu { display:none!important; }"));\ndocument.body.appendChild(s);\nrq \x3d 1;\nreturn;\n}\n}\nif (ajaxurl) {\nif (!blogList) {\nrequest_blog_list();\n}\n}\n});\n})();\n(function() {\n// You probably do not want to change this function, but just in\n// case I leave it here right under your eyes.. ;-)\nfunction addPixels(oldPx, addPx) {\nvar iOld \x3d parseInt(oldPx);\nif (isNaN(iOld)) iOld \x3d 0;\nvar iAdd \x3d parseInt(addPx);\nif (isNaN(iAdd)) iAdd \x3d 0;\nreturn (iOld+iAdd)+"px";\n}\nvar eltStyle \x3d document.createElement("style");\neltStyle.setAttribute("type", "text/css");\neltStyle.appendChild(document.createTextNode("dummy"));\ndocument.getElementsByTagName("head")[0].appendChild(eltStyle);\nfunction setHtmlMarginTop(marg) {\n// We need to add a style element for the html margin-top\n// since it is set with !important and rules. Even direct\n// element styles with important are then overriden.\neltStyle.replaceChild(\ndocument.createTextNode("html {margin-top:"+marg+"!important;}"),\neltStyle.firstChild\n);\n}\nvar eMh1 \x3d document.getElementById("mh1");\nvar inWP \x3d eMh1.classList.contains("mh1-wp");\nif (!inWP) {\nvar eMh1Shadow \x3d document.createElement("div");\neMh1Shadow.setAttribute("id", "mh1-shadow");\ndocument.body.insertBefore(eMh1Shadow, document.body.firstChild);\n}\nvar mh1Height;\nvar eltAdminFake;\nif (inWP \x26\x26 !document.body.classList.contains("admin-bar")) {\n// Looks like themes are looking for .admin-bar in body and then\n// #wpadminbar. Let us for the moment fake those if they are not there.\n// console.log("did not find admin-bar");\ndocument.body.classList.add("admin-bar");\neltAdminFake \x3d document.createElement("div");\neltAdminFake.setAttribute("id", "wpadminbar");\nvar s \x3d eltAdminFake.style;\n// Seems like we now must make us at least 32px tall (at least\n// for some themes):\nif (parseInt(mh1Height) \x3c 32) {\nmh1Height \x3d "32px";\n// fix-me: looks like jQuery: ???\nmh1.css("height", mh1Height);\n}\ns.height \x3d mh1Height;\ns.minHeight \x3d mh1Height;\ns.position \x3d "fixed";\ns.top \x3d "-"+mh1Height;\ns.left \x3d "0";\n// Try to keep it small:\ns.padding \x3d "0";\ns.margin \x3d "0";\ns.fontSize \x3d "8px";\ns.lineHeight \x3d "10px";\ndocument.body.appendChild(eltAdminFake);\n} \nvar eAdmin \x3d document.getElementById("wpadminbar");\nvar eHtml \x3d document.getElementsByTagName("html")[0];\nfunction doResizing() {\n// console.log("doResizing ----------------");\nvar rMh1 \x3d eMh1.getBoundingClientRect();\nfunction adjustHtmlMarginTop() {\n// mh1Height \x3d jqMh1.outerHeight();\nmh1Height \x3d rMh1.height;\n// console.log("mh1Height", mh1Height);\nvar adminHeight \x3d 0;\nif (!eltAdminFake) adminHeight \x3d window.getComputedStyle(eAdmin).height;\n// console.log("adminHeight", adminHeight);\nvar newHtmlMarginTop \x3d addPixels(adminHeight, mh1Height);\n// console.log("newHtmlMarginTop", newHtmlMarginTop);\n// console.log("adminHeight", adminHeight);\neMh1.style.top \x3d adminHeight;\n// console.log(eMh1.style.top, eMh1);\nsetHtmlMarginTop(newHtmlMarginTop);\n}\nif (inWP)\nadjustHtmlMarginTop();\nelse\neMh1Shadow.style.height \x3d rMh1.height+"px";\nvar htmlWidth \x3d eHtml.clientWidth;\n// console.log("htmlWidth", htmlWidth);\nif (htmlWidth \x3e 699) {\nvar menus \x3d document.getElementById("mh1-search");\nmenus.style.height \x3d null;\nmenus.style.display \x3d null;\nmenus.style.position \x3d null;\n}\n}\n// https://developer.mozilla.org/en-US/docs/Web/Reference/Events/resize\nvar optimizedResize \x3d (function() {\nvar callbacks \x3d [],\nchanged \x3d false,\nrunning \x3d false; \n// fired on resize event\nfunction resize() {\nif (!running) {\nchanged \x3d true;\nloop();\n}\n}\n// resource conscious callback loop\nfunction loop() {\nif (!changed) { \nrunning \x3d false; \n}\nelse {\nchanged \x3d false;\nrunning \x3d true; \ncallbacks.forEach(function(callback) {\ncallback();\n});\nwindow.requestAnimationFrame(loop);\n}\n}\n// adds callback to loop\nfunction addCallback(callback) {\nif (callback) {\ncallbacks.push(callback);\n}\n}\nreturn {\n// initalize resize event listener\ninit: function(callback) {\nif (window.requestAnimationFrame) { \nwindow.addEventListener(\'resize\', resize);\naddCallback(callback);\n}\n},\n// public method to add additional callback\nadd: function(callback) {\naddCallback(callback);\n},\nfakeResize: function() { resize(); }\n}\n})();\n// start resizing process\noptimizedResize.init(\ndoResizing\n);\n// Fix-me: This one does not work correctly - there is a 1px\n// glitch. Tried a fake resize event. Did not correct it, but\n// needed anyway.\n// \n// adjustHtmlMarginTop();\noptimizedResize.fakeResize();\n})();\n']})});function A(b,c){if(!c)debugger;if(!c||!/^[0-9]+$/.exec(c))throw"Bad id '"+c+"' in ZURLBuilder";this.m=b;this.id=c}A.prototype.j="https://api.zotero.org/";A.prototype.h="?format\x3datom\x26content\x3djson";function L(b){return b.j+(b.m?"groups":"users")+"/"+b.id+"/"}A.prototype.item=function(b){if(!b)debugger;return L(this)+"items/"+b+this.h};function M(b,c){if(!c)debugger;return L(b)+"items/"+c}function N(b,c){if(!c)debugger;return L(b)+"items/"+c+"?format\x3dbib\x26style\x3dapa"}
A.prototype.children=function(b){if(!b)debugger;return L(this)+"items/"+b+"/children"+this.h+"\x26order\x3ddateAdded\x26sort\x3dasc"};function O(b,c,f,e,s,y){this.n=b;this.a=c;this.d=f;this.g=e;this.e=s;this.k=y;this.status={}}
O.prototype.onload=function(){debugger;console.log("prototype xhr callback ",this.b.status,this.b);if(4!==this.b.readyState){console.log("readyState",this.b.readyState);alert("wrong zreader onload function called");debugger}if(200<=this.b.status&&400>this.b.status){if(this.a)for(this.a.classList.remove("zreader-requested"),this.a.classList.add("zreader-received");this.a.firstChild;)this.a.removeChild(this.a.firstChild);var b=this.b.responseText;this.g&&this.g(b,this.a);this.d&&(b=R(b),this.d(b,this.a));
this.e&&this.e()}else console.log("Couldn't read the requested file,\x3cbr /\x3estatus \x3d "+this.b.status.toString()),this.a&&(this.a.classList.remove("zreader-requested"),this.a.classList.add("zreader-error"),this.a.appendChild(S("div",null,["Couldn't read the requested file",S("br"),"STATUS \x3d "+this.b.status.toString()])))};function V(b){if(!b.b)b.b=W(b.n,b.a,b.d,b.g,b.e,b.k,b.status);else if(4===b.b.readyState)b.b.onload()}
function W(b,c,f,e,s,y,x){console.log("zRR",b,"statusObj",x);var v=c?c.dataset.c:void 0;x&&(v=x.status);switch(v){case void 0:x&&(x.status="requested");c&&(v=S("div",{"class":"zreader-request-info"},"Fetching information from Zotero... (this might not work on mobiles due to a bug in Chrome)"),x||(c.dataset.c="requested",c.classList.remove("zreader-error"),c.classList.remove("zreader-received"),c.classList.add("zreader-requested")),c.appendChild(v));var l=new XMLHttpRequest;l.onerror=function(a){logIt(l.statusText);
logIt(a)};l.onload=function(){if(200<=l.status&&400>l.status){x&&(x.status="received");if(c)for(x||(c.dataset.c="received",c.classList.remove("zreader-requested"),c.classList.add("zreader-received"));c.firstChild;)c.removeChild(c.firstChild);var a=l.responseText;e&&e(a,c);f&&(a=R(a),f(a,c));s&&s()}else console.log("Couldn't read the requested file,\x3cbr /\x3estatus \x3d "+l.status.toString()),x&&(x.status="failed"),c&&(x||(c.dataset.c="failed",c.classList.remove("zreader-requested"),c.classList.add("zreader-error")),
c.appendChild(S("div",null,["Couldn't read the requested file",S("br"),"status \x3d "+l.status.toString()])),y&&y())};l.ontimeout=function(){logIt("rq.ontimeout "+b)};l.onreadystatechange=function(){4===l.readyState&&200!==l.status&&console.log("Error",l.statusText)};l.open("GET",b,!0);try{l.send()}catch(h){logIt(h)}return l}}
function R(b){theJX=b;E=b=(new DOMParser).parseFromString(b,"text/xml").querySelectorAll("entry");for(var c=[],f=0;f<b.length;f++){var e=b[f],s=e.getElementsByTagNameNS("http://zotero.org/ns/api","key")[0].textContent,y=e.querySelector("published").textContent,e=e.querySelector("content").firstChild.nodeValue,e=JSON.parse(e);e.zoteroItemKey=s;e.zoteroPublished=y;c[f]=e}return J=c}
function S(b,c,f){function e(b){"string"==typeof b?s.appendChild(document.createTextNode(b)):s.appendChild(b)}var s=document.createElement(b);if(f)if(f.length&&"string"!=typeof f)for(b=0;b<f.length;b++)f[b]&&e(f[b]);else e(f);for(var y in c)s.setAttribute(y,c[y]);return s}function X(b,c){var f=new XMLHttpRequest;f.open("get","http://ourcomments.org/cgi-bin/zlibdesc.php?zlib\x3d"+b,!0);f.onerror=function(b){logIt(rq.statusText);logIt(b)};f.onload=function(){c(f)};try{f.send()}catch(e){logIt(e)}}
function Y(b,c,f){for(;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(S("span",null,"Fetching info..."));f.style.display="block";X(b,function(e){for(;f.firstChild;)f.removeChild(f.firstChild);var s=S("div",{"class":"libinfo-header",title:"Visit Zotero"},["Zotero library ",S("a",{href:b},c)]);if(200<=e.status&&400>e.status){var y=e.responseText;e=S("div");e.innerHTML=y;for(var y=e.querySelectorAll("a"),x=0,v;v=y[x++];){var l=v.getAttribute("href");"/"===l.substr(0,1)&&v.setAttribute("href",
"https://www.zotero.org"+l)}f.appendChild(s);f.appendChild(e)}else f.innerHTML="Could not get info. Please right click on link.",console.log("Couldn't read the requested file, status \x3d "+e.status.toString())})};ZReaderRefCopier={l:function(b){var c="undefined"!=typeof tinymce?tinymce.i.o():document.getElementsByTagName("textarea")[0];if("none"==c.style.display)console.log("insert into tinymce"),tinymce.i.execCommand("mceInsertContent",!1,"some text");else if(console.log("insert into textarea at caret pos"),c.selectionStart||0===c.selectionStart){var f=c.selectionStart,e=c.scrollTop;c.value=c.value.substring(0,f)+b+c.value.substring(c.selectionEnd,c.value.length);c.focus();c.selectionStart=f+b.length;c.selectionEnd=
f+b.length;c.scrollTop=e}else console.log("no browser support, IE?"),alert("Please switch to Visual editing mode first")},showForm:function(b,c){function f(){function f(b,a){var c=b[0],g=document.createDocumentFragment();g.appendChild(h("h3",null,c.title));var d=c.abstractNote;if(d&&(d=d.trim(),0<d.length)){var c=d.split("\n"),e="sixteen columns";500<d.length&&(e+=" newspaper-cols");d=S("div",{"class":e});for(e=0;e<c.length;e++)0<d.childNodes.length&&d.appendChild(S("div",{"class":"br"})),d.appendChild(document.createTextNode(c[e]));
g.appendChild(d);a.appendChild(g)}}function e(a,d){zDom=(new DOMParser).parseFromString(a,"application/xml");for(var g=zDom.getElementsByTagNameNS("http://zotero.org/ns/api","year")[0],f=zDom.getElementsByTagNameNS("http://zotero.org/ns/api","creatorSummary")[0],g=h("div",null,["(",h("a",{"data-href":"#"+("z"+b+"-"+c),"class":"zrefcopier-short-ref"},[f?f.firstChild:"(unknown author)"," ",g?g.firstChild:"20xx"]),")"]);g.firstChild;)d.appendChild(g.firstChild)}function x(a,e){function f(a,b){b(a);for(var d=
a.firstChild;d;){var c=d.nextSibling;f(d,b);d=c}}var t=(new DOMParser).parseFromString(a,"text/html").querySelector("div.csl-entry");h("a",{id:"z"+b+"-"+c,"class":"zreader-anchor"},h("span",{"class":"zreader-hidden-anchor"},"*"));f(t,function(a){if("#text"==a.nodeName){var b=a.nodeValue,d=/(.*?doi:)(\S+)(.*)/.exec(b);if(d){var c=document.createDocumentFragment();c.appendChild(document.createTextNode(d[1]));c.appendChild(S("a",{href:"http://dx.doi.org/"+d[2],xtarget:"_blank"},d[2]));0<d[3].length&&
c.appendChild(document.createTextNode(d[3]));a.parentNode.replaceChild(c,a)}if(d=/(.*?)(https?:\/\/\S+)(.*)/.exec(b))c=document.createDocumentFragment(),c.appendChild(document.createTextNode(d[1])),c.appendChild(S("a",{href:d[2],xtarget:"_blank"},d[2])),0<d[3].length&&c.appendChild(document.createTextNode(d[3])),a.parentNode.replaceChild(c,a)}});var p=h("a",{href:"http://ourcomments.org/cgi-bin/zformat.php?"+["zk\x3d"+d,"zgi\x3d"+g,"f\x3dhttp://ourcomments.org/psych/zfsp.html"].join("\x26")},"in"+
String.fromCharCode(160)+"Zotero"),p=h("span",null,[" (",p,")"]);for(t.appendChild(p);e.firstChild;)e.removeChild(e.firstChild);for(t=document.importNode(t,!0);t.firstChild;)e.appendChild(t.firstChild)}var v=document.getElementById("zrefcopier-bg");if(v)v.style.display="flex";else{var l=function(a,c){console.log("updateOutput",a,c);if(a)if(c)q.push(a);else for(var b=0;b<q.length;b++)q[b]===a&&q.splice(b,1);if(p){for(;r.firstChild;)r.removeChild(r.firstChild);for(b=0;b<q.length;b++)switch(r.appendChild(h("hr")),
q[b]){case "citation":for(r.appendChild(z);z.firstChild;)z.removeChild(z.firstChild);T||(T=new O(N(p,d),z,null,x));V(T);break;case "abstract":for(r.appendChild(I);I.firstChild;)I.removeChild(I.firstChild);if(!u){var g=p.item(d);u=new O(g,I,f)}V(u);break;case "short":for(r.appendChild(k);k.firstChild;)k.removeChild(k.firstChild);U||(U=new O(M(p,d),k,null,e));V(U);break;default:console.log("bad value in outputList",q)}r.appendChild(h("hr"))}},h=S,v=h("div",{id:"zrefcopier-bg"});document.body.appendChild(v);
var a=v.style;a.position="fixed";a.top="0";a.left="0";a.width="100%";a.height="100%";a.background="rgba(30, 30, 30, 0.7)";a.zIndex="100";a.cursor="wait";var D=h("a",{id:"zrefcopier-closeform",title:"Close"},String.fromCharCode(10006)),G=h("div",{id:"zrefcopier-header"},[h("span",null,"From here you can copy and paste with formatting to Wordpress, LibreOffice etc. "),h("a",{href:"javascript:alert('more info is coming soon')"},"More info")]),B,K;c||(B=h("input",{id:"zrefcopier-url",type:"text"}),K=
h("label",null,["Enter URL of reference in Zotero",B]));h("div");var r=h("div",{id:"zrefcopier-view",contenteditable:"false"}),F=h("div",{id:"zrefcopier-view-container"},[r]),C=h("div",{id:"zrefcopier-inner-controls"}),P=h("button",{title:"Insert in edited post/page"},"Insert"),Q=h("div",{id:"zrefcopier-selectall",xtitle:"Select all text"},"Select all text");F.appendChild(Q);var t=h("div",{id:"zrefcopier-outer-controls"},[C,P]),H=h("div",{id:"zrefcopier-copy"},"Now press Control-C to copy to clipboard"),
G=h("div",{id:"zrefcopier-form"},[G,K,t,F,D,H]);K=h("div",{id:"zrefcopier-form-container"},G);v.appendChild(K);a.cursor=null;B&&B.focus();D.addEventListener("click",function(){w()});var g=b,d="TI6C7MH6",d="EZBTRX9P",d=c,p;g&&(p=new A(!0,g));g?(Q.style.display="inline-block",P.style.display="none"):(Q.style.display="none",P.style.display="inline-block");var q=[],a=h("input",{id:"zrefcopier-lnk-chk",type:"checkbox",checked:"checked"}),D=h("label",{title:""},[a,"Short referens"]);C.appendChild(D);var k=
h("p");a.addEventListener("click",function(){l("short",this.checked)});a=h("input",{id:"zrefcopier-cit-chk",type:"checkbox",checked:"checked"});D=h("label",{title:""},[a,"Referens"]);C.appendChild(D);var z=h("blockquote",{"class":"zrefcopier-referens",id:"z"+b+"-"+c});a.addEventListener("click",function(){l("citation",this.checked)});a=h("input",{id:"zrefcopier-abs-chk",type:"checkbox"});D=h("label",{title:""},[a,"Abstract"]);C.appendChild(D);var I=h("blockquote",{id:"zrefcopier-abstract"});a.addEventListener("click",
function(){l("abstract",this.checked)});l("short",!0);l("citation",!0);a.focus();C=function(){var a=null;return function(){var b=B.value;if(b!=a){a=b;for(delete z.dataset.c;z.firstChild;)z.removeChild(z.firstChild);for(delete I.dataset.c;I.firstChild;)I.removeChild(I.firstChild);for(delete k.dataset.c;k.firstChild;)k.removeChild(k.firstChild);d=d||(!0)[2];g||(g="56508");p=new A(!0,g);l()}}}();B&&(B.addEventListener("change",C),B.addEventListener("keyup",C));P.addEventListener("click",function(){var a=
r.cloneNode(!0).innerHTML;ZReaderRefCopier.l(a);v.style.display="none"});Q.addEventListener("click",function(){var a=document.createRange();a.selectNodeContents(r);window.getSelection().removeAllRanges();window.getSelection().addRange(a)});r.addEventListener("focus",function(){var a=document.createRange();a.selectNode(r);window.getSelection().removeAllRanges();window.getSelection().addRange(a)});var w=function(){v.style.display="none"};document.addEventListener("keydown",function(a){a.stopPropagation();
H.style.display="none";27==a.keyCode&&w()});v.addEventListener("click",function(a){a.stopPropagation();w()});G.addEventListener("click",function(a){a.stopPropagation();a.stopImmediatePropagation()});v.addEventListener("focusout",function(a){a.stopPropagation();var b=a.relatedTarget;if(b){a=a.target;var d=!1;for(n=0;!d&&b&&30>n++;)b=b.parentNode,d=b===v;d||a&&a.focus()}})}var u,T,U}var e=document.getElementById("zrefcopier-css");if(!e){if(e=document.createElement("link"),document.head.appendChild(e),
e.setAttribute("id","zrefcopier-css"),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href","http://dl.dropboxusercontent.com/u/848981/it/z/css/edit.css"),e.onload=function(){O&&S&&f()},O&&S)return}else if(O&&S){f();return}e=document.createElement("script");document.head.appendChild(e);e.setAttribute("id","zrefcopier-js");e.onload=function(){f()};e.src="http://dl.dropboxusercontent.com/u/848981/it/z/js/zreader.js";console.log("waiting for zreader.js ...")}};(function(){function b(b,c){return a("div",{"class":"drow"},[a("span",{"class":"dt"},b),a("span",{"class":"dd"},c)])}function c(c,f){var t=c[0],H=document.createDocumentFragment(),g=t.url;if(!g){var d=t.DOI;d&&(g="http://dx.doi.org/"+d)}g?h=g:g="javascript:alert('Sorry, I do not know the link. It might be in the attachments below!'); void(0)";d=t.title;H.appendChild(b("Title",a("h1",{"class":"h1-title",id:"ref-title"},a("a",{href:g,xtarget:"_blank",title:"Visit source",itemprop:"name"},d))));document.head.appendChild(a("title",
null,"Z: "+d));var p=document.createDocumentFragment(),q=t.creators,k="";if(q){for(g=0;g<q.length;g++){var z=q[g].firstName,s=q[g].lastName;if(s||z)if(s=s.trim(),z=z.trim(),0<s.length||0<z.length)0<p.length&&p.appendChild(document.createTextNode(", ")),p.appendChild(a("span",{itemprop:"author"},z+" "+s));0===g&&(k=z+" "+s)}0<p.childElementCount&&H.appendChild(b("Authors",p))}if(g=t.abstractNote)if(g=g.trim(),0<g.length){document.querySelector("head meta[name\x3d'twitter:description']").setAttribute("content",
g.substr(0,200));p=g.split("\n");q="sixteen columns";500<g.length&&(q+=" newspaper-cols");q=a("div",{"class":q});for(g=0;g<p.length;g++)0<q.childNodes.length&&q.appendChild(a("div",{"class":"br"})),z=a("span",null),z.innerHTML=p[g],q.appendChild(z);H.appendChild(b("Abstract",q))}if(p=t.date)p=p.trim(),q=/[0-9]{4}/.exec(p),q[0]&&(0<k.length&&(k+=" "),k+="("+q[0]+")");0<k.length&&(k+=". ");k+=d;document.querySelector("head meta[name\x3d'twitter:title']").setAttribute("content",k);p&&0!=p.length||(p=
t.accessDate+" (accessed)");p&&(p=", "+p);d=G[t.itemType]||t.itemType;k=t.publicationTitle||t.websiteTitle||t.publisher;if(!k){if(g=t.url)q=/https?:\/\/[^/]*/.exec(g),k=a("a",{href:g,xtarget:"_blank"},q[0]);k||(k="Unknown source")}H.appendChild(b(d,[k,p]));k=t.tags;if(0<k.length){d=a("div",{id:"tag-container"});p=[];q=[];for(g=0;g<k.length;g++)z=k[g],q[g]=a("input",{type:"checkbox",style:"display:none"}),q[g].addEventListener("click",function(a){a.stopPropagation();this.checked?(this.parentNode.classList.add("checked-tag"),
this.style.display="inline-block"):(this.style.display="none",this.parentNode.classList.remove("checked-tag"));a=document.getElementById("tag-container").querySelectorAll(".checked-tag");document.getElementById("glass-cont").style.opacity=0<a.length?1:null}),p[g]=a("label",{"class":"tag"},[z.q,q[g]]),d.appendChild(p[g]);g=a("a",{id:"search-tags",xtarget:"_blank"},"Search for tags");g.addEventListener("click",function(){for(var a=document.getElementById("tag-container").querySelectorAll(".checked-tag"),
b="",d=0;d<a.length;d++)0<b.length&&(b+=" "),b+='"'+a[d].firstChild.nodeValue+'"';this.setAttribute("href",l.f+"?q\x3d"+encodeURIComponent(b))});g=a("div",{id:"search-tags-div",style:"display:none"},g);H.appendChild(b("Tags",[d,g]))}a("span",{id:"cite-div",title:"Show citation"},"â–º").addEventListener("click",function(){var a=N(B,r),b=document.getElementById("cite-div");b.appendChild(document.createTextNode("Waiting for citation from Zotero ..."));W(a,b,null,e)});d=a("a",{id:"copy-ref",href:"#"},"Copy reference etc");
d.addEventListener("click",function(a){a.stopPropagation();a.stopImmediatePropagation();a.preventDefault();x(K,r)});for(H.appendChild(b("Cite",d));f.firstChild;)f.removeChild(f.firstChild);f.appendChild(H);D=t.relations;v()}function f(b,c){function f(){for(var a=document.getElementById("output-attachments").querySelectorAll("img"),b=/https?:\/\/[^/]+\//,d=0,c=a.length;d<c;d++){var g=a[d],e=g.parentNode.getAttribute("href"),t=b.exec(e)[0]+"favicon.ico";RegExp(/^Full ?text$/).test(g.parentNode.textContent)?
t="https://dl.dropboxusercontent.com/u/848981/it/z/img/fulltext.svg":/nih.gov\//.test(t)?t="http://www.ncbi.nlm.nih.gov/favicon.ico":/dropboxusercontent/.test(t)?t="http://www.zotero.org/favicon.ico":e.substr(0,p.length)===p&&(t="http://dl.dropboxusercontent.com/u/848981/it/z/favicon.ico");a[d].setAttribute("src",t)}}function e(){return a("img",{width:"16",height:"16"})}function g(a){h=a;document.querySelector("#ref-title a").setAttribute("href",a)}var d=/[^?]*/.exec(window.location.href),p=d[0];
"complete"==document.readyState?setTimeout(f,1):window.onload=f;for(var q=a("div",{"class":"inner-container"}),k=a("div",{"class":"inner-container"}),l=a("div",{"class":"inner-container"}),s=a("div",{"class":"inner-container"}),w=0;w<b.length;w++){var u=b[w],v;for(v in u);switch(u.itemType){case "attachment":switch(u.linkMode){case "linked_url":var d=u.url,r=u.title,u="color-other";/facebook.com/i.test(d)?u="color-facebook":/full/i.test(r)?u="color-full":/annot/i.test(r)?u="color-annotation":/diigo/i.test(r)?
u="color-annotation":/nih.gov/i.test(d)?(u="color-pubmed",h||g(d)):/books.google./i.test(d)&&(u="color-book",h||g(d));k.appendChild(a("a",{"class":"attachment linked-url "+u,href:d,xtarget:"_blank"},[e(),a("span",null,r)]));break;case "imported_url":d=u.url;r=u.title;k.appendChild(a("div",{"class":"attachment linked-url"},[a("i",null,r),", imported web page, can be accessed from desktop Zotero."]));break;case "imported_file":d=u.url;r=u.title;k.appendChild(a("div",{"class":"imported-file attachment"},
[a("i",null,r),", attached file, can be accessed from desktop Zotero."]));break;default:console.log("unhandled linkMode:",u)}break;case "note":d=u.note;u=a("div",{"class":"note attachment"},null);u.innerHTML=d;l.appendChild(u);break;default:console.log("unhandled child:",u)}}if("undefined"!==typeof php_parent_zid){d=php_parent_zid;v=php_parent_zgrp;var x=p+"?zgi\x3d"+v+"\x26zk\x3d"+d,y=M(B,d),r=d;(function(){var b=a("span",null,r),d=a("a",{href:x,"class":"related-item attachment color-related"},[e(),
b]);q.appendChild(d);W(y,null,null,function(a){a=(new DOMParser).parseFromString(a,"text/html").querySelector("title").firstChild.nodeValue;b.replaceChild(document.createTextNode(a),b.firstChild)})})()}if(D&&0<Object.keys(D).length){u=/^https?:\/\/zotero.org\/groups\/([0-9]+)\/items\/(.*)$/;a("div",{"class":"related-container"});for(var F in D){var C=D["dc:relation"];"string"==typeof C&&(C=[C]);for(var w=0,K=C.length;w<K;w++)d=u.exec(C[w]),v=d[1],d=d[2],x=p+"?zgi\x3d"+v+"\x26zk\x3d"+d,y=M(B,d),r=
d,function(){var b=a("span",null,r),d=a("a",{href:x,"class":"related-item attachment color-related"},[e(),b]);s.appendChild(d);W(y,null,null,function(a){a=(new DOMParser).parseFromString(a,"text/html").querySelector("title").firstChild.nodeValue;b.replaceChild(document.createTextNode(a),b.firstChild)})}()}}if(0<q.children.length+k.children.length+l.children.length+s.children.length&&(0<q.children.length&&(w=a("div",{"class":"outer-container",id:"links-container"}),w.appendChild(a("div",{"class":"etc-label-div"},
a("span",{"class":"etc-label"},"Owner parent"))),w.appendChild(q),c.appendChild(w)),0<k.children.length&&(w=a("div",{"class":"outer-container",id:"links-container"}),w.appendChild(a("div",{"class":"etc-label-div"},a("span",{"class":"etc-label"},"Links"))),w.appendChild(k),c.appendChild(w)),0<l.children.length&&(w=a("div",{"class":"outer-container",id:"notes-container"}),w.appendChild(a("div",{"class":"etc-label-div"},a("span",{"class":"etc-label"},"Notes"))),w.appendChild(l),c.appendChild(w)),0<s.children.length)){var w=
a("div",{"class":"outer-container",id:"related-container"}),k=a("summary",null,"note"),G=a("span",{style:"display:none"},"Due to a bug in Zotero relations are not displayed both ways. So the relation you see here may not be seen on related documents below. (Hm, it might be gone now. No, it is not!)");k.addEventListener("click",function(){G.style.display="none"==G.style.display?"inline-block":"none"});w.appendChild(a("div",{"class":"etc-label-div"},[a("span",{"class":"etc-label"},"Related"),a("details",
{id:"zot-rel-problems"},[k,G])]));w.appendChild(s);c.appendChild(w)}}function e(b,c){function e(a,b){b(a);for(var c=a.firstChild;c;){var f=c.nextSibling;e(c,b);c=f}}zDom=(new DOMParser).parseFromString(b,"text/html");var f=zDom.querySelector("div.csl-entry");e(f,function(b){if("#text"==b.nodeName){var c=/(.*?doi:)(\S+)(.*)/.exec(b.nodeValue);if(c){var e=document.createDocumentFragment();e.appendChild(document.createTextNode(c[1]));e.appendChild(a("a",{href:"http://dx.doi.org/"+c[2],xtarget:"_blank"},
c[2]));0<c[3].length&&e.appendChild(document.createTextNode(c[3]));b.parentNode.replaceChild(e,b)}}});c.parentNode.replaceChild(f,c)}function s(){console.log("requestMain -----------------------------");var b=document.getElementById("output");b.replaceChild(a("div",null,a("span",null,"Waiting for main content from Zotero...")),b.firstChild);var e=B.item(r);W(e,b,c,y)}function y(a){console.log("getLibFromXml -----------------------------");var b=document.getElementById("lib-title");if(!(0<b.childNodes.length)){a=
(new DOMParser).parseFromString(a,"text/html");var c=a.querySelector("entry link[rel\x3dalternate]");if(c){c=c.getAttribute("href");m=/^https?:\/\/.*?zotero.org\/groups\/([^/]*)/.exec(c);console.log("m",m);F=m[1];var e="http://zotero.org/groups/"+F;console.log("grpTextId",F);RegExp(/^\d+$/).exec(F)&&(F=a.querySelector("title").textContent);var g=F.split("_").join(" ");console.log("libName",g);a=e;b.appendChild(document.createTextNode(g));b=document.getElementById("zotlink");a+="/items/itemKey/"+r;
b.setAttribute("href",a);b.style.opacity=1;document.getElementById("libinfolink").addEventListener("click",function(a){a.preventDefault();a.stopPropagation();console.log("clicked");a=document.querySelector("#libinfo");"block"===a.style.display?a.style.display="none":"none"===a.style.display?a.style.display="block":Y(e,g,a)})}else W(L(B),null,null,y)}}function x(b,c){if("undefined"===typeof ZReaderRefCopier){var e;if(RegExp(/\.php\?/).exec(location.href)){var f=document.querySelector("base");f?e=f.href:
function(){var a=document.querySelector("#zformat-js");e=RegExp(/(.*?\/)js\/[^\/]*$/).exec(a.src)[1]}()}else e=location.protocol+"//"+location.host+location.pathname,e=e.replace(/\/zformat.html.*$/,"/");f=a("script",{id:"ourcomments-edit-js"});document.head.appendChild(f);f.onload=function(){ZReaderRefCopier.showForm(b,c)};f.src=e+"js/edit.js"}else ZReaderRefCopier.showForm(b,c)}function v(){console.log("requestChildren ----------------------------");var a=document.getElementById("output-attachments");
if("undefined"===typeof php_parent_zid){var b=B.children(r);W(b,a,f,y)}else f([],a)}var l=new function(a){if(1<a.length)for(var b=0,c=a.substr(1).split("\x26");b<c.length;b++)a=c[b].split("\x3d"),this[decodeURIComponent(a[0])]=1<a.length?decodeURIComponent(a[1]):""}(window.location.search);l.f="http://OurComments.org/psych/zfsp.html";var h,a=S,D=null,G={book:"Book",journalArticle:"Journal Article",newspaperArticle:"News Article",webpage:"Web Page"},B,K=l.zgi,r=l.zk,F=l.zit,C=l.z;(function(){function a(){if(C){var b=
/https?:\/\/www.zotero.org\/groups\/(.*?)\/items\/itemKey\/([^/]*)/.exec(C);F=F||b[1];r=r||b[2]}B=new A(!0,K);document.getElementById("output").style.display="block";document.getElementById("glass2").addEventListener("mousedown",function(){var a="",b=window.getSelection().toString();0<b.length&&(a='"'+b+'"');if(b=document.getElementById("tag-container"))for(var b=b.querySelectorAll(".checked-tag"),c=0;c<b.length;c++)0<a.length&&(a+=" "),a+='"'+b[c].firstChild.nodeValue+'"';this.setAttribute("href",
l.f+"?q\x3d"+encodeURIComponent(a))});document.getElementById("glass2").addEventListener("touchstart",function(a){a.target.p()});document.body.addEventListener("mouseup",function(){document.getElementById("glass-cont").style.opacity=0<window.getSelection().toString().length?1:null});"undefined"!==typeof php_json?c([php_json],document.getElementById("output")):s()}switch(document.readyState){case "loading":document.addEventListener("DOMContentLoaded",function(){a()});break;case "interactive":case "complete":a();
break;default:debugger}})()})();})();